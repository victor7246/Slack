!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n(t.RedsiftCore=t.RedsiftCore||{})}(this,function(t){function n(t,n){var e={lossy:"UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",lossless:"UklGRhoAAABXRUJQVlA4TA0AAAAvAAAAEAcQERGIiP4HAA==",alpha:"UklGRkoAAABXRUJQVlA4WAoAAAAQAAAAAAAAAAAAQUxQSAwAAAARBxAR/Q9ERP8DAABWUDggGAAAABQBAJ0BKgEAAQAAAP4AAA3AAP7mtQAAAA==",animation:"UklGRlIAAABXRUJQVlA4WAoAAAASAAAAAAAAAAAAQU5JTQYAAAD/////AABBTk1GJgAAAAAAAAAAAAAAAAAAAGQAAABWUDhMDQAAAC8AAAAQBxAREYiI/gcA"},o=new Image;o.onload=function(){var e=o.width>0&&o.height>0;n(t,e)},o.onerror=function(){n(t,!1)},o.src="data:image/webp;base64,"+e[t]}function e(t){var n=t[0]/255,e=t[1]/255,o=t[2]/255;n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92,e=e>.04045?Math.pow((e+.055)/1.055,2.4):e/12.92,o=o>.04045?Math.pow((o+.055)/1.055,2.4):o/12.92;var r=.4124*n+.3576*e+.1805*o,i=.2126*n+.7152*e+.0722*o,a=.0193*n+.1192*e+.9505*o;return[100*r,100*i,100*a]}function o(t){var n,o,r,i=e(t),a=i[0],u=i[1],l=i[2];return a/=95.047,u/=100,l/=108.883,a=a>.008856?Math.pow(a,1/3):7.787*a+16/116,u=u>.008856?Math.pow(u,1/3):7.787*u+16/116,l=l>.008856?Math.pow(l,1/3):7.787*l+16/116,n=116*u-16,o=500*(a-u),r=200*(u-l),[n,o,r]}function r(t){var n=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;t=t.replace(n,function(t,n,e,o){return n+n+e+e+o+o});var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]:(console.log("Could not parse color",t),[0,0,0])}function i(t,n,e){if(n=Math.round(n),e=Math.round(e),e<0)return Promise.reject("bad duration");if(0===e)return t.scrollTop=n,Promise.resolve("no-duration");var o=Date.now(),r=o+e,i=t.scrollTop,a=n-i,u=function(t,n,e){if(e<=t)return 0;if(e>=n)return 1;var o=(e-t)/(n-t);return o*o*(3-2*o)};return new Promise(function(n,e){var l=t.scrollTop,c=null,s=function(){var e=Date.now(),s=u(o,r,e),f=Math.round(i+a*s);return t.scrollTop=f,e>=r?(window.clearInterval(c),void n("done")):t.scrollTop===l&&t.scrollTop!==f?(window.clearInterval(c),void n("limit")):void(l=t.scrollTop)};c=setInterval(s,10)})}function a(t,n){return function(e){var o=document.getElementById(t);if(void 0===o)return!0;n=n||0;var r=c(o).top+n;return i(document.body,r,T).catch(function(t){console.error(t)}),e.preventDefault(),!1}}function u(t,n,e){e=e||window;var o=!1,r=function(){o||(o=!0,requestAnimationFrame(function(){e.dispatchEvent(new CustomEvent(n)),o=!1}))};e.addEventListener(t,r)}function l(){var t=window.scrollY;b.forEach(function(n){for(var e=n[0],o=n[1],r=n[2],i=n[4],a=!1,u=0;u<i.length;u++){var l=i[u];if(a=t>l.start&&t<l.end)break}a!==o&&(n[1]=a,a?e.classList.add(r):e.classList.remove(r))})}function c(t){var n=document,e=window,o=n.body,r=void 0!==e.pageXOffset?e.pageXOffset:(n.documentElement||o.parentNode||o).scrollLeft,i=void 0!==e.pageYOffset?e.pageYOffset:(n.documentElement||o.parentNode||o).scrollTop,a=t.getBoundingClientRect();if(t!==o)for(var u=t.parentNode;u!==o;)r+=u.scrollLeft,i+=u.scrollTop,u=u.parentNode;return{bottom:a.bottom+i,height:a.height,left:a.left+r,right:a.right+r,top:a.top+i,width:a.width}}function s(){b.forEach(function(t){for(var n=t[0].getBoundingClientRect(),e=t[3],o=document.querySelectorAll(e),r=[],i=0;i<o.length;i++){var a=o[i],u=c(a);r.push({start:u.top-n.height,end:u.bottom})}t[4]=r})}function f(t,n){var e=t.min||0,o=t.max||100,r=Math.ceil((t.value-e)/(o-e)*100);try{C.deleteRule(n)}catch(t){}C.addRule("input[type=range].rs-index-"+n+"::-webkit-slider-runnable-track","background-size:"+r+"% 100%",n)}function A(t,n){for(var e=[],o=0,r=t.length;o<r;++o){var i=Math.max(0,o-5*n),a=Math.min(t.length-1,o+5*n),u=0;e[o]=0;for(var l=i;l<a;++l){var c=Math.exp(-.5*(o-l)*(o-l)/n/n);e[o]+=c*t[l],u+=c}e[o]/=u}return e}function d(){var t=document.createElement("style");t.innerHTML=B,document.body.appendChild(t)}var h={webp:function(t,e){n(t,e)}},p="#fff",v="#000",m=["#ed154f","#ED1651","#C82254","#A62A57","#842F59","#842F59","#35355C","#231F20"],g=64,w={randomTheme:function(){return m[Math.floor(Math.random()*m.length)]},textColorFor:function(t){("string"==typeof t||t instanceof String)&&(t=r(t));var n=o(t);return n[0]<g?p:v},lightnessSort:function(){var t=colors.map(function(t){var n=t;return Array.isArray(t)||(n=r(t)),[o(n),t]}),n=t.sort(function(t,n){return t[0][0]<n[0][0]?-1:t[0][0]>n[0][0]?-1:0});return n.map(function(t){return t[1]})},themes:m},y={localShortMonths:function(t){void 0===t&&(t=navigator.language);var n=null;return n=void 0!==window.Intl?new Intl.DateTimeFormat(t,{month:"short",timeZone:"UTC"}):{format:function(t){return t.toUTCString().split(" ")[2]}},Array.apply(null,Array(12)).map(function(t,e){return n.format(new Date(Date.UTC(2014,e,7)))})},localShortWeekday:function(t){void 0===t&&(t=navigator.language);var n=null;return n=void 0!==window.Intl?new Intl.DateTimeFormat(t,{weekday:"short",timeZone:"UTC"}):{format:function(t){return t.toUTCString().split(" ")[0].substring(0,3)}},Array.apply(null,Array(7)).map(function(t,e){return n.format(new Date(Date.UTC(2014,1,e+2)))})}},T=200,b=[],E={initSmooth:function(t,n){for(var e=document.querySelectorAll(t),o=0;o<e.length;o++){var r=e[o],i=r.attributes.href;if(void 0!==i&&0!==i.length){var u=i.nodeValue.toString();"#"===u.substr(0,1)&&r.addEventListener("click",a(u.substr(1),n),!1)}}},toggleClass:function(t,n,e){var o=document.querySelectorAll(t);o.length>0&&(window.addEventListener("optimizedResize",s),window.addEventListener("optimizedScroll",l));for(var r=0;r<o.length;r++){for(var i=o[r],a=[i,null,n,e,[]],u=!1,c=0;r<b.length;r++)if(b[c][0]==i){b[c]=a,u=!0;break}u||b.push(a)}s(),l()},updateRegions:s};u("scroll","optimizedScroll"),u("resize","optimizedResize");var k={now:function(){var t=window.performance;if(void 0===t)this.now=function(){return(new Date).getTime()};else if(t.now)this.now=function(){return t.now()};else if(t.webkitNow)this.now=function(){return t.webkitNow()};else if(t.msNow)this.now=function(){return t.msNow()};else if(t.oNow)this.now=function(){return t.oNow()};else{if(!t.mozNow)throw new Error("unknown window.performance impl");this.now=function(){return t.mozNow()}}return this.now()}},M=function(t,n){void 0===n&&(n=5),this.treo=t,this.tm={},this.count=0,this.outstanding=[],this.runningTotal=0,this.puts=0,this.max=n,n&&(this.max=n)};M.prototype.countQueue=function(){return this.puts},M.prototype.countTransactionsQueue=function(){return this.outstanding.length},M.prototype.countTransactions=function(){return this.count},M.prototype.runningTransactionTotal=function(){return this.runningTotal},M.prototype.shiftq=function(t,n,e,o){void 0===o&&(o=1);var r=this,i=n.shift();if(i){var a=t.put(i.v,i.k);this.puts=this.puts-1,a.onsuccess=function(){i.r(),r.shiftq(t,n,e,o+1)},a.onerror=function(t){i.j(t)}}else this.tm[e]=null},M.prototype.gate=function(t){function n(){var n=!1;e.count=e.count+1;try{e.runningTotal=e.runningTotal+1,t(function(){n||(n=!0,e.count=e.count-1);var t=e.outstanding.shift();t&&e.gate(t)})}catch(t){throw n||(n=!0,e.count=e.count-1),t}}var e=this;this.count>=this.max?this.outstanding.push(t):n()},M.prototype.put=function(t,n,e){var o=this,r=this.treo,i=this.tm,a=i[t];return this.puts=this.puts+1,new Promise(function(u,l){var c={v:n,r:u,j:l,k:e};null==a?(a=[c],i[t]=a,o.gate(function(n){r.transaction("readwrite",[t],function(e,r){return e?(n(),void a.forEach(function(t){t.j()})):(r.oncomplete=function(){n(),i[t]=null},r.onerror=function(e){a.forEach(function(t){t.j()}),n(),i[t]=null},void o.shiftq(r.objectStore(t),a,t))})})):a.push(c)})};var S={wrap:function(t,n){return new M(t,n)}},R=document.createElement("style");document.head.appendChild(R);var C=R.sheet,Q={initAllRanges:function(){for(var t=document.querySelectorAll("input[type=range]"),n=function(n){var e=t[n];e.className+=" rs-index-"+n,f(e,n),function(t){e.addEventListener("input",function(){f(this,t)})}(n)},e=0;e<t.length;e++)n(e)},setValue:function(t,n){t.value=n;for(var e=document.querySelectorAll("input[type=range]"),o=0;o<e.length;o++)e[o]===t&&f(t,o)}},x={use:function(t){for(var n=document.getElementsByTagName("link"),e=0;e<n.length;e++){var o=n[e];o.rel.indexOf("stylesheet")!=-1&&o.title&&(o.disabled=!0,o.title==t&&(o.disabled=!1))}}},D={wiggle:function(t,n,e,o){return void 0===t&&(t=.93),void 0===n&&(n=.003),void 0===e&&(e=500),void 0===o&&(o=300),function(r){var i=r.map(function(t){return[t[0]/e,t[1]/o]}),a=i.map(function(t,n){if(0==n)return 0;var e=t[0]-i[n-1][0],o=t[1]-i[n-1][1];return Math.sqrt(e*e+o*o)}),u=a.reduce(function(t,n){return n+t},0),l=Math.round(200*u),c=[];a.map(function(t,n){if(0!=n)for(var e=Math.max(3,Math.round(t/u*l)),o=d3.interpolate(i[n-1][1],i[n][1]),r=(i[n][0]-i[n-1][0])/(e-1),a=0,s=i[n-1][0];a<e;++a,s+=r)c.push([s,o(a/(e-1))])});var s=c.map(function(t,n,e){return 0==n?[e[1][0]-e[0][0],e[1][1]-e[0][1]]:n==c.length-1?[e[n][0]-e[n-1][0],e[n][1]-e[n-1][1]]:[.5*(e[n+1][0]-e[n-1][0]),.5*(e[n+1][1]-e[n-1][1])]});s=s.map(function(t){var n=Math.sqrt(t[0]*t[0]+t[1]*t[1]);return 0===n?[0,0]:[t[0]/n,t[1]/n]});var f=A(c.map(d3.random.normal(0,t)),3),d=c.map(function(t,r){var i=f[r],a=s[r];return[((t[0]+n*a[1]*i)*e).toFixed(6),((t[1]-n*a[0]*i)*o).toFixed(6)]});return d.join("L")}}},B="\n  * {\n    -webkit-touch-callout: none;\n    -webkit-user-select: none;\n    -webkit-tap-highlight-color: rgba(0, 0, 0, 0);\n  }\n";t.FeatureDetection=h,t.ColorTools=w,t.Lang=y,t.Scroll=E,t.Timing=k,t.TreoWriter=S,t.Sliders=Q,t.StyleSwitcher=x,t.Xkcd=D,t.cssDisableSelection=d,Object.defineProperty(t,"__esModule",{value:!0})});